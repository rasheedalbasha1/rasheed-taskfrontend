import{load as t}from"cheerio";import*as e from"node-fetch";let r=e;let n=e;export default function({section:e,language:a,since:o="daily",spoken_language_code:i}={}){const c=function(t,e,r,n){const a="https://github.com/trending";let o=t?a+"/developers":a;return o=(e?o+"/"+e:o)+"?since="+r,o=n?o+"&spoken_language_code="+n:o,o}(e,a,o,i);return e?function(e){return new Promise((r,a)=>{n(e).then(t=>t.text()).then(e=>{const n=t(e);let a=n(".Box article.Box-row").get().map(t=>{const e=n(t).find(".h3>a").text().trim(),r=n(t).find(".f4>a").text().trim();return{author:e,username:r,avatar:n(t).find(".mx-3 img").attr("src"),url:"https://github.com/"+r,reponame:n(t).find("article .h4.lh-condensed>a").text().trim(),repourl:"https://github.com"+n(t).find("article .h4.lh-condensed>a").attr("href").trim(),description:n(t).find("article .f6.text-gray.mt-1").text().trim()}});r(a)}).catch(t=>{a(t)})})}(c):function(e){return new Promise((n,a)=>{r(e).then(t=>t.text()).then(e=>{const r=t(e);let a=r(".Box article.Box-row").get().map(t=>{let e=r(t).find("p.col-9").text().trim();const[n,a]=r(t).find(".h3>a").text().split("/").map(t=>t.trim()),o=r(t).find(".h3>a").attr("href"),i=r(t).find("[itemprop=programmingLanguage]").text(),c=r(t).find(".repo-language-color").attr("style"),l=c?c.replace("background-color: ",""):"";let s=r(t).find('span:contains("Built by")>a').map((t,e)=>{const n=r(e).children("img").attr("alt").slice(1);return{username:n,url:"https://github.com/"+n,avatar:r(e).children("img").attr("src")}}).get(),[m,u,d]=r(t).find(".d-inline-block").text().replace(/\,/g,"").match(/(\d+\.|\d+)+/g);return{author:n,reponame:a,repourl:"https://github.com/"+o,repodesc:e,language:i,langcolor:l,stars:+m,forks:+u,laststars:+d,builtby:s}});n(a)}).catch(t=>{a(t)})})}(c)}
